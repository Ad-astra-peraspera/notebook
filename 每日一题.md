| [166.分数到小数](##分数到小数) [url](https://leetcode.cn/problems/fraction-to-recurring-decimal/?envType=daily-question&envId=2025-09-24) | 中等 | 哈希表、取整、格式输出 |
| ------------------------------------------------------------ | ---- | ---------------------- |
|                                                              |      |                        |
|                                                              |      |                        |
|                                                              |      |                        |



----------

## 从分数到小数

最开始，我的疑问是怎么判断循环小数，接着我开始疑惑怎么判断无限不循环小数。

后面发现分数一定是有理数，即是不会出现无限不循环小数。

```python
class Solution:
    def fractionToDecimal(self, numerator: int, denominator: int) -> str:
        ''' 
        难点有2: 1.将数字转化为字符串（不难，用格式输出） 2.判断循环小数.
        如果是循环小数，那么还需要将循环的最小部分截断放入括号内（
循环节).
        此外，还要注意，python的 // 是向下取整！
        '''
        
        # 用追踪余数来做.
        sign = '-' if numerator * denominator < 0 else ''# 记录正负号
        numerator, denominator = abs(numerator), abs(denominator)
        int_part = numerator // denominator # 整数部分       
        remainder = numerator % denominator # 每一轮的余数
        decimals = '' # 用以记录余数
        seen = defaultdict(int) # 使用一个哈希表来记录出现过的余数
    
        # 开始验证是否是有循环
        if remainder == 0:
            return f'{sign}{int_part}'

        while remainder and remainder not in seen:
            seen[remainder] = len(decimals)
            remainder *= 10
            decimals += str(remainder // denominator)
            remainder %= denominator
        
        if remainder == 0: # 如果while循环结束remiander为0，说明不循环
            return f'{sign}{int_part}.{decimals}'
        else: # 注意，循环小数可能是从小数的某一部分开始循环，例如 1 / 6 = 0.16666... 
            repeat_start = seen[remainder]
            # 这个时候的remiander非0，并且被seen哈希表记录了第一次出现在decimals的位置
            non_repeat = decimals[:repeat_start]
            repeat = decimals[repeat_start:]
            return f'{sign}{int_part}.{non_repeat}({repeat})'
```



